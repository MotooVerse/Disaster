<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NewsHub</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
:root{
  --primary:#4361ee;
  --accent:#4cc9f0;
  --bg:#ffffff;
  --text:#111;
  --card:#f5f5f5;
  --success:#4caf50;
  --danger:#f44336;
}
[data-theme="dark"]{
  --bg:#0f172a;
  --text:#f8fafc;
  --card:#1e293b;
}
*{margin:0;padding:0;box-sizing:border-box;font-family:Segoe UI,sans-serif}
body{background:var(--bg);color:var(--text);transition:.3s}
header{
  padding:1rem 5%;
  display:flex;
  justify-content:space-between;
  align-items:center;
  position:sticky;
  top:0;
  background:var(--card);
  z-index:10;
}
nav a{
  margin-left:1rem;
  text-decoration:none;
  color:var(--text);
  font-weight:500;
}
nav a.active{color:var(--primary)}
.hero{text-align:center;padding:4rem 5%}
.hero h1{
  font-size:3rem;
  background:linear-gradient(90deg,var(--primary),var(--accent));
  -webkit-background-clip:text;
  color:transparent;
}
.hero p{opacity:.8;margin-top:.5rem}
.categories{
  display:flex;
  justify-content:center;
  gap:1rem;
  flex-wrap:wrap;
  margin-bottom:2rem;
}
.category{
  padding:.4rem 1rem;
  border-radius:20px;
  background:var(--card);
  cursor:pointer;
}
.category.active{background:var(--primary);color:#fff}
.news-grid{
  padding:0 5% 3rem;
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(300px,1fr));
  gap:1.5rem;
}
.news-card{
  background:var(--card);
  border-radius:12px;
  overflow:hidden;
  position:relative;
}
.news-card img{
  width:100%;
  height:180px;
  object-fit:cover;
}
.news-content{padding:1rem}
.bookmark-btn{
  position:absolute;
  top:10px;
  right:10px;
  width:32px;
  height:32px;
  border:none;
  border-radius:50%;
  cursor:pointer;
  background:#fff;
}
.bookmark-btn.bookmarked{
  background:var(--primary);
  color:#fff;
}
.notification{
  position:fixed;
  top:90px;
  right:20px;
  padding:1rem;
  border-radius:6px;
  color:#fff;
  transform:translateX(150%);
  transition:.3s;
  z-index:99;
}
.notification.show{transform:translateX(0)}
footer{
  text-align:center;
  padding:2rem;
  background:var(--card);
  opacity:.7;
}
</style>
</head>

<body>

<header>
  <div><i class="fa fa-newspaper"></i> <b>NewsHub</b></div>
  <nav>
    <a href="#" data-page="home" class="nav-link active">Home</a>
    <a href="#" data-page="bookmarks" class="nav-link">Bookmarks</a>
  </nav>
  <button id="themeToggle"><i class="fa fa-moon"></i></button>
</header>

<section class="hero">
  <h1>Discover News That Matters</h1>
  <p>Latest headlines from trusted sources</p>
</section>

<div class="categories">
  <div class="category active" data-cat="all">All</div>
  <div class="category" data-cat="technology">Technology</div>
  <div class="category" data-cat="business">Business</div>
  <div class="category" data-cat="sports">Sports</div>
</div>

<div class="news-grid" id="newsGrid"></div>
<div class="notification" id="notification"></div>

<footer>© 2025 NewsHub</footer>

<script>
const API_KEY = "740f66b0345d06095f1db635947729c2";
const PROXY = "https://api.allorigins.win/raw?cache=false&url=";

let currentPage = "home";
let currentCategory = "all";
let currentArticles = [];
let bookmarks = JSON.parse(localStorage.getItem("bookmarks")) || [];

const $ = id => document.getElementById(id);
const $$ = sel => document.querySelectorAll(sel);

function notify(msg, error=false){
  const n = $("notification");
  n.textContent = msg;
  n.style.background = error ? "var(--danger)" : "var(--success)";
  n.classList.add("show");
  setTimeout(()=>n.classList.remove("show"),2500);
}

function formatDate(d){
  return new Date(d).toLocaleString();
}

async function fetchWithFallback(url){
  try{
    const r = await fetch(url);
    if(!r.ok) throw new Error(r.status);
    return await r.json();
  }catch{
    const r = await fetch(PROXY + encodeURIComponent(url));
    return await r.json();
  }
}

async function fetchNews(){
  let url = `https://gnews.io/api/v4/top-headlines?lang=en&country=us&sortby=publishedAt&token=${API_KEY}`;
  if(currentCategory!=="all") url += `&topic=${currentCategory}`;

  try{
    const data = await fetchWithFallback(url);
    if(!data.articles) throw new Error("No articles");
    currentArticles = data.articles;
    renderNews(currentArticles);
  }catch(e){
    notify("News service unavailable", true);
  }
}

function renderNews(list){
  $("newsGrid").innerHTML = "";
  list.forEach((a,i)=>{
    $("newsGrid").innerHTML += `
      <div class="news-card">
        <button class="bookmark-btn ${bookmarks.some(b=>b.title===a.title)?"bookmarked":""}"
          onclick="toggleBookmark(${i})">
          <i class="fa fa-bookmark"></i>
        </button>
        <img src="${a.image || `https://picsum.photos/600/400?${i}`}">
        <div class="news-content">
          <h3>${a.title}</h3>
          <p>${a.description || ""}</p>
          <small>${a.source.name} • ${formatDate(a.publishedAt)}</small>
        </div>
      </div>`;
  });
}

function toggleBookmark(i){
  const a = currentArticles[i];
  const exists = bookmarks.find(b=>b.title===a.title);
  bookmarks = exists
    ? bookmarks.filter(b=>b.title!==a.title)
    : [...bookmarks,a];
  localStorage.setItem("bookmarks",JSON.stringify(bookmarks));
  notify(exists?"Bookmark removed":"Bookmark added");
  loadPage(currentPage);
}

function loadPage(p){
  currentPage=p;
  $$(".nav-link").forEach(l=>l.classList.toggle("active",l.dataset.page===p));
  p==="bookmarks"?renderNews(bookmarks):fetchNews();
}

$$(".category").forEach(c=>{
  c.onclick=()=>{
    $$(".category").forEach(x=>x.classList.remove("active"));
    c.classList.add("active");
    currentCategory=c.dataset.cat;
    fetchNews();
  };
});

$$(".nav-link").forEach(l=>{
  l.onclick=e=>{
    e.preventDefault();
    loadPage(l.dataset.page);
  };
});

$("themeToggle").onclick=()=>{
  document.documentElement.dataset.theme =
    document.documentElement.dataset.theme==="dark"?"light":"dark";
};

fetchNews();
</script>

</body>
</html>
